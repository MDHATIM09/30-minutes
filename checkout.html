<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Checkout - 30-MINUTES</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 p-4 sm:p-6">

  <h1 class="text-2xl sm:text-3xl font-bold mb-4 sm:mb-6">üßæ Checkout</h1>

  <div id="cartItems" class="mb-6 overflow-x-auto"></div>
<form id="checkoutForm" class="bg-white p-4 sm:p-6 rounded shadow-md mb-6 max-w-xl mx-auto">
  <h2 class="text-lg sm:text-xl font-semibold mb-4">üìç Delivery Details</h2>

  <!-- Delivery Fields (same as before) -->
  <div class="mb-4">
    <label for="house" class="block text-base font-medium mb-1">üè† House / Flat / Block No.</label>
    <input id="house" type="text" placeholder="E.g. A-21" class="w-full px-4 py-2 border rounded" required>
  </div>

  <div class="mb-4">
    <label for="area" class="block text-base font-medium mb-1">üìç Apartment / Road / Area</label>
    <input id="area" type="text" placeholder="E.g. Green Park, Main Road" class="w-full px-4 py-2 border rounded" required>
  </div>

  <div class="mb-4">
    <label for="direction" class="block text-base font-medium mb-1">üß≠ Direction to Reach (Optional)</label>
    <input id="direction" type="text" placeholder="Landmark, etc." class="w-full px-4 py-2 border rounded">
  </div>

  <div class="mb-4">
    <label for="receiverName" class="block text-base font-medium mb-1">üë§ Receiver's Name</label>
    <input id="receiverName" type="text" placeholder="E.g. Ahmed Khan" class="w-full px-4 py-2 border rounded" required>
  </div>

  <div class="mb-4">
    <label for="phone" class="block text-base font-medium mb-1">üìû Receiver's Phone Number</label>
    <input id="phone" type="tel" placeholder="E.g. 9876543210" pattern="[0-9]{10}" class="w-full px-4 py-2 border rounded" required>
  </div>

  <!-- Payment Method -->
  <div class="mb-4">
    <label class="block text-base font-medium mb-2">üí∞ Select Payment Method</label>
    <div class="flex flex-col space-y-2">
      <label class="inline-flex items-center">
        <input type="radio" name="paymentMethod" value="online" class="mr-2" required>
        <span>Pay Online (via UPI/QR Code)</span>
      </label>
      <label class="inline-flex items-center">
        <input type="radio" name="paymentMethod" value="cod" class="mr-2">
        <span>Cash on Delivery (Pay ‚Çπ29 now, rest on delivery)</span>
      </label>
    </div>
  </div>

  <!-- COD Message -->
  <div id="codInfo" class="bg-yellow-100 border border-yellow-300 text-yellow-800 p-3 rounded mb-4 hidden">
    üí° To confirm your COD order, please pay ‚Çπ29 now. The remaining amount is payable at delivery.
  </div>

  <!-- QR Code Section -->
  <div id="onlinePaymentInfo" class="bg-blue-100 border border-blue-300 text-blue-800 p-3 rounded mb-4 hidden text-center">
    <p class="mb-2 font-semibold">Scan & Pay via UPI</p>
    <img src="https://via.placeholder.com/150" alt="QR Code" class="mx-auto mb-2 w-40 h-40 object-contain rounded border border-gray-300">
    <p>UPI ID: <span class="font-mono">yourupi@upi</span></p>
  </div>

  <!-- Submit -->
  <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded font-semibold">
    ‚úÖ Place Order
  </button>
</form>


  <script>
    const cartItemsContainer = document.getElementById("cartItems");
    const cart = JSON.parse(localStorage.getItem("cart")) || [];

    if (cart.length === 0) {
      cartItemsContainer.innerHTML = "<p class='text-gray-600 text-lg'>Your cart is empty.</p>";
    } else {
      let total = 0;
      let html = `
        <div class="overflow-x-auto">
          <table class="min-w-full bg-white rounded shadow-md overflow-hidden mb-4 text-sm sm:text-base">
            <thead class="bg-gray-200 text-left">
              <tr>
                  <th class="p-3">Image</th>
                  <th class="p-3">Product</th>
                  <th class="p-3">Price</th>
                  <th class="p-3">Qty</th>
                  <th class="p-3">Subtotal</th>
              </tr>
            </thead>
            <tbody>
      `;

      cart.forEach(item => {
        const subTotal = item.price * item.quantity;
        total += subTotal;
        html += `
          <tr class="border-t">
            <td class="p-3"><img src="${item.image}" alt="${item.name}" class="h-12 w-12 sm:h-16 sm:w-16 object-cover rounded" /></td>
            <td class="p-3 break-words max-w-[120px] sm:max-w-xs">${item.name}</td>
            <td class="p-3">‚Çπ${item.price}</td>
            <td class="p-3">${item.quantity}</td>
            <td class="p-3">‚Çπ${subTotal}</td>
          </tr>
        `;
      });

      let discount = total > 499 ? 100 : 0;
      let deliveryCharge = total - discount < 499 ? 39 : 0;
      let finalAmount = total - discount + deliveryCharge;

      html += `
            </tbody>
          </table>
        </div>
        <div class="text-sm sm:text-base">
          <p class="font-semibold">Total: ‚Çπ${total}</p>
          ${discount > 0 ? `<p class="text-green-600 font-semibold">Coupon Applied: -‚Çπ100</p>` : ""}
          ${deliveryCharge > 0 
            ? `<p class="text-red-600 font-semibold">Delivery fee: ‚Çπ${deliveryCharge}</p>` 
            : `<p class="text-green-600 font-semibold">Delivery fee: Free</p>`}
          <p class="text-lg sm:text-xl font-bold mt-2">Amount Payable: ‚Çπ${finalAmount}</p>
        </div>
      `;

      cartItemsContainer.innerHTML = html;
    }

    document.getElementById("checkoutForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const house = document.getElementById("house").value.trim();
      const area = document.getElementById("area").value.trim();
      const direction = document.getElementById("direction").value.trim();
      const receiverName = document.getElementById("receiverName").value.trim();
      const phone = document.getElementById("phone").value.trim();

      if (!house || !area || !receiverName || !phone) {
        alert("‚ùóPlease fill all the required fields before placing the order.");
        return;
      }

      if (!/^[0-9]{10}$/.test(phone)) {
        alert("‚ùóPlease enter a valid 10-digit phone number.");
        return;
      }

      localStorage.removeItem("cart");
      window.location.href = "success.html";
    });
    
  // Payment Option Logic
  const codInfo = document.getElementById("codInfo");
  const onlinePaymentInfo = document.getElementById("onlinePaymentInfo");
  const paymentRadios = document.querySelectorAll('input[name="paymentMethod"]');

  paymentRadios.forEach(radio => {
    radio.addEventListener("change", () => {
      if (radio.value === "cod") {
        codInfo.classList.remove("hidden");
        onlinePaymentInfo.classList.add("hidden");
      } else if (radio.value === "online") {
        codInfo.classList.add("hidden");
        onlinePaymentInfo.classList.remove("hidden");
      }
    });
  });

  // Extend your submit handler
  document.getElementById("checkoutForm").addEventListener("submit", function (e) {
    e.preventDefault();

    const house = document.getElementById("house").value.trim();
    const area = document.getElementById("area").value.trim();
    const direction = document.getElementById("direction").value.trim();
    const receiverName = document.getElementById("receiverName").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked');

    if (!house || !area || !receiverName || !phone) {
      alert("‚ùóPlease fill all the required fields before placing the order.");
      return;
    }

    if (!/^[0-9]{10}$/.test(phone)) {
      alert("‚ùóPlease enter a valid 10-digit phone number.");
      return;
    }

    if (!paymentMethod) {
      alert("‚ùóPlease select a payment method.");
      return;
    }

    // Simulate confirmation
    alert(`‚úÖ Order Placed Successfully via ${paymentMethod.value === "cod" ? "COD (with ‚Çπ29 upfront)" : "Online Payment"}`);

    // You can add further logic here like actual payment handling if needed
    localStorage.removeItem("cart");
    window.location.href = "success.html";
  });


  </script>
</body>
</html>
