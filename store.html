<div id="store-list"></div>

<script>
  const userLat = parseFloat(localStorage.getItem("userLat"));
  const userLng = parseFloat(localStorage.getItem("userLng"));

  const stores = [/* your store data with lat/lng here */];

  function calculateDistance(lat1, lng1, lat2, lng2) {
    const R = 6371; // Radius of Earth in KM
    const dLat = (lat2 - lat1) * Math.PI / 180;
    const dLng = (lng2 - lng1) * Math.PI / 180;
    const a =
      Math.sin(dLat / 2) * Math.sin(dLat / 2) +
      Math.cos(lat1 * Math.PI / 180) *
      Math.cos(lat2 * Math.PI / 180) *
      Math.sin(dLng / 2) * Math.sin(dLng / 2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    return R * c;
  }

  function showNearbyStores() {
    const nearbyStores = stores.filter(store => {
      const distance = calculateDistance(userLat, userLng, store.lat, store.lng);
      return distance <= 4;
    });

    const container = document.getElementById("store-list");
    nearbyStores.forEach(store => {
      const div = document.createElement("div");
      div.innerHTML = `
        <img src="${store.image}" width="150">
        <h3>${store.name}</h3>
        <a href="${store.link}">Visit Store</a>
      `;
      container.appendChild(div);
    });
  }

  showNearbyStores();
</script>
